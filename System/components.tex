\section{System Components}
\label{Comp}

This section expands on the brief overview given in the previous section \ref{sys:arch}, describing in detail the functionality of each of the components:

\subsection{Crawler}
	\label{Comp:Crawler}
	We used an open-source Crawler built at University of California - Santa Barbara. The Crawler provides us with a continuous feed of URLs and the HTML contained in those pages. This feed is tunneled to our Form Parser over a Celery Queue.
	
\subsection{Form Parser}
	\label{Comp:FP}
	The actual pipeline begins at the Form Parser. This module is responsible for parsing the HTML and retrieving data about the forms on the page, including the following:
	\begin{itemize}
		\item Form attributes, such as method, action, etc. These dictate where we send the HTTP Request, and what kind of request it is (GET or POST).
		\item Data about the input fields, such as their attributes, names, and default values. The default values are essential for fields like \colorbox{lightgray}{\lstinline{<input type="hidden">}} as these fields are usually used to check for the submission of forms by bots.
		\item Presence of the \colorbox{lightgray}{\lstinline{<base>}} element, as this affects the final URL to which the form is to be submitted.
		\item Headers associated with the page, such as \emph{referrer}. Once again, these were required to avoid the website from ignoring our system as a bot.
	\end{itemize} 
	The Form Parser stores all this data in our Databases, so as to allow us to reconstruct the forms later for fuzzing, as needed.

\subsection{E-Mail Field Checker}
	\label{Comp:EMFC}
	The E-Mail Field  Checker script is the next stage in the pipeline. It receives the output of the previous stage - Form Data from the queue, and checks for the presence of E-Mail fields in those forms. If any E-Mail fields are found, it stores references to these forms in a separate table. This allows us to separate the forms that are potentially vulnerable from the forms that are not.

	The E-Mail Field Checker particularly searches for the word 'e-mail' or 'email' within the form, instead of an explicit email field (ie) \colorbox{lightgray}{\lstinline{<input type="email">}}. This is by design, taking into account a very common design pattern used by web designers, where they may have a text field with a label called email, instead of an actual E-Mail field, for purposes of backward compatibility with older browsers.
	Instead of an id/name/type of email. ARIA isn't exactly their goal. ikr.
	

\subsection{E-Mail Form Retriever}
	\label{Comp:EMFR}
	Describe the functionality of the EMFR.
		
\subsection{Fuzzer}
	\label{Comp:Fuzzer}
	Describe the functionality of the Fuzzer
	\paragraph{Non-Malicious Payload}
		\label{Comp:Fuzzer:nmp}
		Describes what the regular payload is.
		
	\paragraph{Malicious Payload}
		\label{Comp:Fuzzer:mp}
		Describes what the malicious payloads are.
		
\subsection{E-Mail Analyzer}
	\label{Comp:EMA}
	Describe the functionality of the E-Mail Analyzer
	
\subsection{Database}
