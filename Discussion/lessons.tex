\section{Lessons Learned}
    From our results, it is evident that the vulnerability exists in the wild. Despite its relatively low occurrence rate compared to the more popular SQL Injection and XSS (Cross-Site Scripting), when we take the total number of websites on the World Wide Web and calculate the percentage of that number, we end up with a pretty significant number. We agree that an extrapolation of that kind might not be a good measure of the prevalence of the vulnerability. However, even with as few as a thousand websites affected by this vulnerability, it can still have a disastrous impact on the global Web. 
    
    After analyzing the results, we would like to make a few more observations. We believe that one of the reasons for the small percentage of occurrence (compared to SQL Injection or XSS), can be attributed to what we like to call the `car parking analogy'.
    The car parking analogy is something like this: Imagine that we are parking a car on a road that is prone to attacks by thieves. Now, if all the cars were unlocked, the car that is most likely to get stolen is quite unsurprisingly the most expensive one or the one that is easiest to get away with.
    
    Now imagine the same thing on the World Wide Web, we have websites that can each have multiple vulnerabilities. Now, it makes sense for an attacker to try and attack the website with more widespread and glamorous attacks such as SQL Injection or XSS, rather than attempt to exploit E-Mail Header Injection, seeing as this requires a more concentrated effort, with carefully crafted payloads and a waiting time for the E-Mail to be delivered.
    
    This also gives more incentive for the website developer to add protection against attacks such as SQL injection and XSS. What this does, however, is to (unknowingly) help prevent E-Mail Header Injection. This is explained as follows: E-Mail Header Injection thrives on the ability to inject a newline into the input fields. XSS and SQL Injection Prevention serves to remove special characters like newlines,  and backslashes (encoded or otherwise). 
    
    Thus, indirectly, it affects the attempts to perform E-Mail Header Injection. However, this does not completely negate the attempts if the checks are only on the client-side. Also, even with server-side validation, often, the only input fields that are validated are ones that are either inserted into the database (SQL Injection) and the ones that are displayed back to the user as part of the web site (XSS).

	A second and a far more common reason for our fuzzing attempts to fail is the bot-blocking mechanisms built into the websites. CAPTCHAs (as explained in Section \ref{issues:captcha} and in the following section) pose a very difficult problem for our system to exploit E-Mail Header Injection, even if it is present.

	This does not mean that the vulnerability is not a big threat. In fact,
    as mentioned many times previously, this vulnerability too can have some major consequences, the least of which can be spamming and phishing attacks. In today's digital world, identity theft has become all the more common. E-Mail Header Injection provides attackers with the ability to extract easily information about users, not just from a server, but from the user himself, by sending him fake messages that look extremely authentic, since these messages are sent by the website itself.
    
    From our research, we found two different forms of the E-Mail Header Injection Vulnerability: the first one is the traditional one, where we are able to inject any header into the forms, allowing us complete control over the contents of the E-Mail. We identify this with the presence of both the `bcc' header and the `x-check' header. This is the most potent form of the vulnerability and is found on quite a few websites. This is also the vulnerability that is documented and discussed on many websites.
    
    The second attack is an interesting one, as this has not yet been documented, and provides the ability to inject multiple E-Mail addresses into only the `TO' field. In this form of the vulnerability, we are able to simply add addresses to the `To' field of the form with newlines separating the E-Mail addresses. Whether this particular form of the vulnerability is found due to the websites in question, or whether this is an implementation issue with a particular language or framework, is unclear. However, from our preliminary analysis, it is evident that these websites do not share much with respect to the languages and frameworks used. 
    Even in this form of the attack, we are still able to extract information that should be private to a given user, and in most of these cases, able to inject enough data to spoof the first few lines of the E-Mail message.
    
    While not being as lethal as the primary vulnerability, this second form of the vulnerability does still provide the ability to send the E-Mails to multiple recipients, and can easily result in information leakage, and/or spam generation.
    
